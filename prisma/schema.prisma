// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id       String @id
  name     String @unique
  password String
  type     Int
  email    String
  icon     String

  contest Contestant[]
}

model Contest {
  id          String   @id
  title       String   @unique
  description String
  startAt     DateTime
  endAt       DateTime
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  contestant Contestant[]
  problem    Problem[]
  Submission Submission[]
}

model Problem {
  id          String @id
  title       String @unique
  text        String
  point       Int
  memoryLimit Int
  timeLimit   Int

  case      Case[]
  Contest   Contest? @relation(fields: [contestId], references: [id])
  contestId String?
}

model Case {
  id        String  @id
  input     String
  output    String
  Problem   Problem @relation(fields: [problemId], references: [id])
  problemId String
}

model Submission {
  id       String @id
  code     String
  language String
  status   Int
  point    Int

  judgeStatus  JudgeStatus[]
  Contest      Contest       @relation(fields: [contestId], references: [id])
  contestId    String
  Contestant   Contestant?   @relation(fields: [contestantId], references: [id])
  contestantId String?
}

model JudgeStatus {
  id           String     @id
  memoryUsage  Int
  execTime     Int
  Submission   Submission @relation(fields: [submissionId], references: [id])
  submissionId String
}

model Contestant {
  id        String  @id
  User      User    @relation(fields: [userId], references: [id])
  userId    String
  Contest   Contest @relation(fields: [contestId], references: [id])
  contestId String

  submission Submission[]

  type Int
}
